# 1 å‰è¨€
## 1.1 ä¸šåŠ¡åœºæ™¯
ç”±å‰å°å¯¼å…¥Excelè¡¨æ ¼ï¼Œè·å–æ‰¹é‡æ•°æ®ã€‚

æ ¹æ®ä¸€ä¸ªæ•°ç»„å¯¼å‡ºExcelè¡¨æ ¼ã€‚

# 2 å®ç°åŸç†
## 2.1 å¼•å…¥å·¥å…·åº“
> file-saverã€xlsxã€script-loader

`npm install -S file-saver xlsx`

`npm install -D script-loader`

## 2.2 å¯¼å…¥Excel
### 2.2.1 Element ä¸Šä¼ æ§ä»¶

![](https://user-gold-cdn.xitu.io/2019/3/25/169b4a2da499b54d?w=514&h=89&f=jpeg&s=10663)
```
<el-upload
    class="upload-demo"
    action=""
    :on-change="handleChange"
    :on-exceed="handleExceed"
    :on-remove="handleRemove"
    :file-list="fileListUpload"
    :limit="limitUpload"
    accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"
    :auto-upload="false">
    <el-button size="small" type="primary">ç‚¹å‡»ä¸Šä¼ </el-button>
    <div slot="tip" class="el-upload__tip">åª èƒ½ ä¸Š ä¼  xlsx / xls æ–‡ ä»¶</div>
</el-upload>
```
`limitUpload = 1`é™åˆ¶åªèƒ½ä¸Šä¼ 1ä¸ªæ–‡ä»¶

`accept`ä¸ºé»˜è®¤æ‰“å¼€çš„å¯ä¸Šä¼ çš„æ–‡ä»¶æ ¼å¼
```
handleChange(file, fileList){
    this.fileTemp = file.raw
},

handleRemove(file,fileList){
    this.fileTemp = null
},
```
`fileTemp`è¿™é‡Œå®šä¹‰äº†ä¸€ä¸‹å˜é‡ï¼ŒæŒ‡å‘æœ€æ–°ä¸Šä¼ çš„é™„ä»¶ï¼Œèµ·å§‹å®šä¹‰ä¸ºnullã€‚

è¿™é‡Œå‘ç°æ§ä»¶`file.raw`æ˜¯æˆ‘ä»¬è¦ç”¨çš„`File`ç±»å‹ã€‚

### 2.2.2 å¯¼å…¥åˆ¤æ–­

```
if(this.fileTemp){
    if((this.fileTemp.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet') || (this.fileTemp.type == 'application/vnd.ms-excel')){
        this.importfxx(this.fileTemp)
    } else {
        this.$message({
            type:'warning',
            message:'é™„ä»¶æ ¼å¼é”™è¯¯ï¼Œè¯·åˆ é™¤åé‡æ–°ä¸Šä¼ ï¼'
        })
    }
} else {
    this.$message({
        type:'warning',
        message:'è¯·ä¸Šä¼ é™„ä»¶ï¼'
    })
}
```
### 2.2.3 å¯¼å…¥å‡½æ•°

```
importfxx(obj) {
    let _this = this;
    // é€šè¿‡DOMå–æ–‡ä»¶æ•°æ®
    this.file = obj
    var rABS = false; //æ˜¯å¦å°†æ–‡ä»¶è¯»å–ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²
    var f = this.file;
    var reader = new FileReader();
    //if (!FileReader.prototype.readAsBinaryString) {
    FileReader.prototype.readAsBinaryString = function(f) {
        var binary = "";
        var rABS = false; //æ˜¯å¦å°†æ–‡ä»¶è¯»å–ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²
        var pt = this;
        var wb; //è¯»å–å®Œæˆçš„æ•°æ®
        var outdata;
        var reader = new FileReader();
        reader.onload = function(e) {
        var bytes = new Uint8Array(reader.result);
        var length = bytes.byteLength;
        for(var i = 0; i < length; i++) {
            binary += String.fromCharCode(bytes[i]);
        }
        var XLSX = require('xlsx');
        if(rABS) {
            wb = XLSX.read(btoa(fixdata(binary)), { //æ‰‹åŠ¨è½¬åŒ–
                type: 'base64'
            });
        } else {
            wb = XLSX.read(binary, {
                type: 'binary'
            });
        }
        outdata = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);//outdataå°±æ˜¯ä½ æƒ³è¦çš„ä¸œè¥¿
            this.da = [...outdata]
            let arr = []
            this.da.map(v => {
                let obj = {}
                obj.code = v['è®¾å¤‡ID']
                obj.type = v['è®¾å¤‡å‹å·']
                arr.push(obj)
            })
            return arr
        }
        reader.readAsArrayBuffer(f);
    }
    
    if(rABS) {
        reader.readAsArrayBuffer(f);
    } else {
        reader.readAsBinaryString(f);
    }
},
```
`arr`å°±æ˜¯æˆ‘ä»¬è¦çš„ç»“æœï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚æ¯ä¸€ä¸ªå€¼æ˜¯ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†`code` `type`ä¸¤ä¸ªå±æ€§ã€‚

excelä¸­æ ¼å¼ä¸ºæ¨ªå‘ è®¾å¤‡ID å’Œ è®¾å¤‡å‹å·ã€‚

## 2.3 å¯¼å‡ºExcel
### 2.3.1 å¼•å…¥JSæ–‡ä»¶
å¯å‚è€ƒä¸‹è½½åœ°å€ï¼š- [github](https://github.com/xrkffgg/tools/tree/master/JS/Excel)

å°†å…¶ä¸­çš„2ä¸ªJSæ–‡ä»¶æ”¾å…¥åˆ°è‡ªå·±çš„å·¥ç¨‹ä¸­ã€‚
### 2.3.2 ä¿®æ”¹JSæ–‡ä»¶ä¸­åœ°å€

![](https://user-gold-cdn.xitu.io/2019/4/1/169d6c69e65d2507?w=563&h=241&f=png&s=35758)
æ‰“å¼€`Export2Excel.js`ï¼Œä¼šå‡ºç°å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ç”±äºæœ¬äººå°†`Blob.js`å’Œ`Export2Excel.js`æ”¾åˆ°äº†åŒä¸€çº§ï¼Œè¿™é‡Œå¼•å…¥æ˜¯è¿™æ ·çš„ã€‚

è¿™å‡ ä¸ªæ–‡ä»¶ä¸æ”¯æŒimportå¼•å…¥ï¼Œæ‰€ä»¥éœ€è¦`script-loader`æ¥å°†ä»–ä»¬æŒ‚è½½åˆ°å…¨å±€ç¯å¢ƒä¸‹ã€‚
### 2.3.3 å¯¼å‡ºå‡½æ•°

```
getExcel(res) {
    require.ensure([], () => {
        const { export_json_to_excel } = require('../../introduce/Export2Excel.js')
        const tHeader = ['å§“å', 'å¹´é¾„']
        const filterVal = ['name', 'age']
        const list = res
        const data = this.formatJson(filterVal, list)
        export_json_to_excel(tHeader, data, 'å¯¼å‡ºåˆ—è¡¨åç§°')
    })
},

formatJson(filterVal, jsonData) {
    return jsonData.map(v => filterVal.map(j => v[j]))
},
```

è¿™é‡Œçš„å¼•ç”¨è¯·æ ¹æ®è‡ªå·±çš„å±‚çº§å…³ç³»å’Œæ–‡ä»¶å¤¹å‘½å`require('../../introduce/Export2Excel.js')`

`res`ä¸ºä¼ å…¥çš„æ•°ç»„ï¼Œæ ¼å¼å¦‚ï¼š`res =[{name:'å°ç™½',age:'18'},{name:'å°é»‘',age:'16'}]`

`tHeader`ä¸ºå¯¼å‡ºExcelè¡¨å¤´åç§°ï¼Œ`å¯¼å‡ºåˆ—è¡¨åç§°`å³ä¸ºå¯¼å‡ºExcelåç§°

ä¸‹è½½çš„Excelä½ç½®æ ¹æ®æµè§ˆå™¨è®¾ç½®çš„ä¸‹è½½ä½ç½®è€Œå®š



# 3 åè®°
**æ„Ÿè°¢æ”¯æŒã€‚è‹¥ä¸è¶³ä¹‹å¤„ï¼Œæ¬¢è¿å¤§å®¶æŒ‡å‡ºï¼Œå…±å‹‰ã€‚**

**å¦‚æœè§‰å¾—ä¸é”™ï¼Œè®°å¾— ç‚¹èµ ï¼Œè°¢è°¢å¤§å®¶** ğŸ˜‚
> **æ¬¢è¿å…³æ³¨ æˆ‘çš„ï¼š** [ã€Githubã€‘](https://github.com/xrkffgg/Tools)[ã€æ˜é‡‘ã€‘](https://juejin.im/user/59c369496fb9a00a4843a3e2/posts)[ã€ç®€ä¹¦ã€‘](https://www.jianshu.com/u/4ca4daac5890)[ã€CSDNã€‘](https://blog.csdn.net/xrk_ffgg)[ã€OSCHINAã€‘](https://my.oschina.net/xrkffgg)[ã€SFã€‘](https://segmentfault.com/u/xrkffgg/articles)
## 3.1 å‚è€ƒèµ„æ–™
- [www.cnblogs.com/liguiwang..](https://www.cnblogs.com/liguiwang/p/8430672.html)
- [www.cnblogs.com/qiu...](https://www.cnblogs.com/qiu-Ann/p/7743897.html)
  
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="çŸ¥è¯†å…±äº«è®¸å¯åè®®" style="border-width:0" src="https://user-gold-cdn.xitu.io/2019/4/23/16a4837df5394a7c?w=88&h=31&f=png&s=1888" /></a><br />æœ¬æ–‡ç« é‡‡ç”¨<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®</a>è¿›è¡Œè®¸å¯ã€‚

**å‡ºå¤„ä¸ºï¼š**[https://github.com/xrkffgg/Tools](https://github.com/xrkffgg/Tools)